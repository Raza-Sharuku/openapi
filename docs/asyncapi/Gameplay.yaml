asyncapi: 2.6.0  # 3.0.0から2.6.0に変更
info:
  title: Pong Logic API
  version: 1.0.0
  description: Websocketを用いてPongロジックとのリアルタイム通信を行うAPIです。
servers:
  production:
    url: localhost:8443/gameplay.ws/ponglogic/{settingId}  # hostとpathnameをurlに統合
    protocol: wss
    variables:
      settingId:
        default: '1'
        description: Game setting ID
channels:
  game:
    subscribe:  # receiveを明示的にsubscribeとして定義
      message:
        name: receivePaddleInstruction
        contentType: application/json
        payload:
          type: object
          required:
            - side
            - move_direction
            - action
          properties:
            side:
              type: string
              enum:
                - left
                - right
            move_direction:
              type: string
              enum:
                - up
                - down
            action:
              type: string
              enum:
                - start
                - stop
    publish:  # sendを明示的にpublishとして定義
      message:
        oneOf:  # 複数のメッセージタイプを定義
          - name: sendPongData
            contentType: application/json
            payload:
              type: object
              properties:
                id:
                  type: integer
                  description: "このponglogicが使用しているGamesettingのid"
                left_paddle_y:
                  type: integer
                  description: "左パドルのy座標"
                right_paddle_y:
                  type: integer
                  description: "右パドルのy座標"
                ball_x:
                  type: integer
                  description: "ボールのx座標"
                ball_y:
                  type: integer
                  description: "ボールのy座標"
                ball_radius:
                  type: integer
                  description: "ボールの半径"
                left_score:
                  type: integer
                  description: "左プレイヤーの得点"
                right_score:
                  type: integer
                  description: "右プレイヤーの得点"
                obstacle1_x:
                  type: integer
                  description: "障害物1のx座標 (初回のみ)"
                obstacle1_y:
                  type: integer
                  description: "障害物1のy座標 (初回のみ)"
                obstacle1_width:
                  type: integer
                  description: "障害物1の幅 (初回のみ)"
                obstacle1_height:
                  type: integer
                  description: "障害物1の高さ (初回のみ)"
                obstacle2_x:
                  type: integer
                  description: "障害物2のx座標 (初回のみ)"
                obstacle2_y:
                  type: integer
                  description: "障害物2のy座標 (初回のみ)"
                obstacle2_width:
                  type: integer
                  description: "障害物2の幅 (初回のみ)"
                obstacle2_height:
                  type: integer
                  description: "障害物2の高さ (初回のみ)"
                blind_x:
                  type: integer
                  description: "ボール隠しのx座標 (初回のみ)"
                blind_y:
                  type: integer
                  description: "ボール隠しのy座標 (初回のみ)"
                blind_width:
                  type: integer
                  description: "ボール隠しの幅 (初回のみ)"
                blind_height:
                  type: integer
                  description: "ボール隠しの高さ (初回のみ)"
          - name: sendGameOver
            contentType: application/json
            payload:
              type: object
              properties:
                type:
                  type: string
                  enum:
                    - game_over
                  description: "このmessageのタイプ"
                winner:
                  type: string
                  description: "勝者の名前"
                left_score:
                  type: integer
                  description: "左プレイヤーの得点"
                right_score:
                  type: integer
                  description: "右プレイヤーの得点"